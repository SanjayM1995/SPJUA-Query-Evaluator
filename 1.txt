CREATE TABLE CUSTOMER (C_CUSTKEY INTEGER, C_NAME STRING, C_ADDRESS STRING, C_NATIONKEY INTEGER, C_PHONE STRING, C_ACCTBAL DOUBLE, C_MKTSEGMENT STRING, C_COMMENT STRING);


CREATE TABLE NATION(N_NATIONKEY INTEGER, N_NAME STRING, N_REGIONKEY INTEGER, N_COMMENT STRING);


CREATE TABLE REGION(R_REGIONKEY INTEGER, R_NAME STRING, R_COMMENT STRING);


CREATE TABLE PLAYERS ( ID STRING, FIRSTNAME STRING, LASTNAME STRING, FIRSTSEASON INTEGER, LASTSEASON INTEGER, WEIGHT INTEGER, BIRTHDATE DATE);


CREATE TABLE ORDERS (O_ORDERKEY INTEGER, O_CUSTKEY INTEGER, O_ORDERSTATUS STRING, O_TOTALPRICE DOUBLE, O_ORDERDATE DATE, O_ORDERPRIORITY STRING, O_CLERK STRING, O_SHIPPRIORITY INTEGER, O_COMMENT STRING);


CREATE TABLE LINEITEM (L_ORDERKEY INTEGER, L_PARTKEY INTEGER, L_SUPPKEY INTEGER, L_LINENUMBER INTEGER, L_QUANTITY DOUBLE, L_EXTENDEDPRICE DOUBLE, L_DISCOUNT DOUBLE, L_TAX DOUBLE, L_RETURNFLAG STRING, L_LINESTATUS STRING, L_SHIPDATE DATE, L_COMMITDATE DATE, L_RECEIPTDATE DATE, L_SHIPINSTRUCT STRING, L_SHIPMODE STRING, L_COMMENT STRING);


SELECT SUM(SUB_Q.P1_WEIGHT*1.0)
FROM
  (SELECT P1.FIRSTNAME AS P1_FIRSTNAME,
          P1.LASTNAME AS P1_LASTNAME,
          P2.FIRSTNAME AS P2_FIRSTNAME,
          P2.LASTNAME AS P2_LASTNAME,
          P1.FIRSTSEASON AS P1_FIRSTSEASON,
          P1.LASTSEASON AS P1_LASTSEASON,
          P2.FIRSTSEASON AS P2_FIRSTSEASON,
          P2.LASTSEASON AS P2_LASTSEASON,
          P1.WEIGHT AS P1_WEIGHT
   FROM PLAYERS P1,
        PLAYERS P2
   WHERE P1.ID = P2.ID
     AND P1.FIRSTSEASON < 2007) SUB_Q;


